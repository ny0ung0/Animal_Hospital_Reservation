<div class="header_wrap" th:fragment="header">
<header class="border-bottom">
	<div class="d-flex bg-user-sub p-2 px-3">
		<div class="d-lg-none">
			<a href="#" onclick="openMobileMenu()" class="navbar-brand">ë©”ë‰´</a>
		</div>
		<div class="ms-auto d-flex">
		<a id="chat" href="/user/chatList" class="navbar-brand me-4" style="display:none;">ğŸ’¬ ì±—íŒ…</a>
		<a id="login-link" class="navbar-brand" href="/login_form">ë¡œê·¸ì¸</a>
		<div id="mypage-link" class="navbar-brand" style="display: none;">
			<div class="dropdown">
			  <a class="btn btn-none dropdown-toggle nav-link rounded-0" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
			   ë§ˆì´í˜ì´ì§€
			  </a>
			
			  <ul class="dropdown-menu">
			    <li><a class="dropdown-item" href="/user/my_info_edit">ë‚´ ì •ë³´ ìˆ˜ì •</a></li>
			    <li><a class="dropdown-item" href="#">ë‚´ê°€ ì“´ ë³‘ì› ë¦¬ë·°</a></li>
			    <li><a class="dropdown-item" href="#">ì»¤ë®¤ë‹ˆí‹°(ì§‘ìˆ˜ë‹¤) ê´€ë¦¬</a></li>
			    <li><a class="dropdown-item" href="/user/myPetList">ë°˜ë ¤ë™ë¬¼ ë¦¬ìŠ¤íŠ¸</a></li>
			    <li><a class="dropdown-item" href="#">ê²½ë§¤ ì°¸ì—¬ ë‚´ì—­</a></li>
			    <li><a class="dropdown-item" href="#">í€ë”© ì°¸ì—¬ ë‚´ì—­</a></li>
			    <li><a class="dropdown-item" href="#">ì¿ í°í•¨</a></li>
			    <li><a class="dropdown-item" href="#">í¬ì¸íŠ¸ ê´€ë¦¬</a></li>
			    <li><a class="dropdown-item" href="/user/fav_vet_list">ì¦ê²¨ì°¾ê¸° ë‚´ì—­</a></li>
			    <li><a class="dropdown-item" href="/user/myQnaList">ë¬¸ì˜ë‚´ì—­</a></li>
			  </ul>
			</div>
		
		</div>
		<span class="mx-3" id ="bar"> | </span>
		<a id="logout-link" class="navbar-brand" href="#" onclick="logout()" style="display: none;">ë¡œê·¸ì•„ì›ƒ</a>
		<a id="register-link" class="navbar-brand" href="/register_form">íšŒì›ê°€ì…</a>
		</div>
	</div>
	<div class="d-flex flex-wrap justify-content-center align-items-center py-3">
      <a href="/" class="d-flex align-items-center mb-md-0 me-md-auto ps-md-3 link-body-emphasis text-decoration-none">
      <div class="logo_size">
        <img src="/images/logo_user.png" class="w-100" alt="ë¡œê³ ">
        </div>
        
      </a>

      <ul class="nav nav-pills user-nav d-none d-lg-flex">
        <li class="nav-item"><a href="/" class="nav-link fs-5 rounded-0" aria-current="page">ë‚´ì£¼ë³€ ë™ë¬¼ë³‘ì›</a></li>
        <li class="nav-item"><a href="/user/vet_list_region" class="nav-link fs-5 rounded-0">ì§€ì—­ë³„ ë™ë¬¼ë³‘ì›</a></li>
        <li class="nav-item"><a href="/user/reserv_list" class="nav-link fs-5 rounded-0">ë³‘ì› ì˜ˆì•½ ë‚´ì—­</a></li>
        <li class="nav-item"><a href="#" class="nav-link fs-5 rounded-0">ì´ë²¤íŠ¸ ê²½ë§¤</a></li>
        <li class="nav-item"><a href="#" class="nav-link fs-5 rounded-0">í€ë”©</a></li>
        <li class="nav-item"><a href="/webGame/" class="nav-link fs-5 rounded-0">í«í‚¤ìš°ê¸°</a></li>
        <li class="nav-item"><a href="#" class="nav-link fs-5 rounded-0">ì§‘ìˆ˜ë‹¤</a></li>
        <li class="nav-item">
	        <div class="dropdown">
			  <a class="btn btn-none dropdown-toggle nav-link fs-5 rounded-0" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
			   ê³ ê°ì„¼í„°
			  </a>
			
			  <ul class="dropdown-menu">
			    <li><a class="dropdown-item" href="/noticeList">ê³µì§€ì‚¬í•­</a></li>
			    <li><a class="dropdown-item" href="/qnaForm">ë¬¸ì˜ì‘ì„±</a></li>
			  </ul>
			</div>
		</li>
      </ul>
	</div>
	

<div id="mobileMenu" class="bg-user-sub">
	<div class="d-flex border-bottom border-white border-opacity-50 justify-content-center align-items-center pe-4">
		 <a href="/" class="d-block text-decoration-none">
			<div class="logo_size">
	        	<img src="/images/logo_user.png" class="w-100" alt="ë¡œê³ ">
	        </div>
        </a>
		<a id="mobileMenuCloseBtn" class="d-block ms-auto nav-link">X</a>
	</div>
	<div class="px-4">
		<ul class="list-group list-group-flush bg-user-sub">
		    <li class="list-group-item bg-user-sub border-white border-opacity-50"><a href="/" class="nav-link fs-5">ë‚´ì£¼ë³€ ë™ë¬¼ë³‘ì›</a></li>
		    <li class="list-group-item bg-user-sub border-white border-opacity-50"><a href="/user/vet_list_region" class="nav-link fs-5">ì§€ì—­ë³„ ë™ë¬¼ë³‘ì›</a></li>
		    <li class="list-group-item bg-user-sub border-white border-opacity-50"><a href="/user/reserv_list" class="nav-link fs-5">ë³‘ì› ì˜ˆì•½ ë‚´ì—­</a></li>
		    <li class="list-group-item bg-user-sub border-white border-opacity-50"><a href="#" class="nav-link fs-5">ì´ë²¤íŠ¸ ê²½ë§¤</a></li>
		    <li class="list-group-item bg-user-sub border-white border-opacity-50"><a href="#" class="nav-link fs-5">í€ë”©</a></li>
		    <li class="list-group-item bg-user-sub border-white border-opacity-50"><a href="/webGame/" class="nav-link fs-5">í«í‚¤ìš°ê¸°</a></li>
		    <li class="list-group-item bg-user-sub border-white border-opacity-50 fs-5">ê³ ê°ì„¼í„°</li>
		    <li class="list-group-item bg-user-sub border-white border-opacity-50"><a href="/noticeList" class="nav-link fs-6 ps-3">ê³µì§€ì‚¬í•­</a></li>
		    <li class="list-group-item bg-user-sub border-white border-opacity-50"><a href="/qnaForm" class="nav-link fs-6 ps-3">ë¬¸ì˜ì‘ì„±</a></li>
		</ul>
	</div>
</div>
</header>
<script src="https://www.gstatic.com/firebasejs/9.9.3/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.9.3/firebase-messaging-compat.js"></script>
<script src="/js/fcm.js"></script>
<script src="/js/fcmsend.js"></script>
<script>
    function logout() {
        localStorage.clear();
        window.location.href = "/";
    }
    
//     function mypage() {
//         window.location.href = "/user/my_info_edit";
//     }
    
    document.addEventListener("DOMContentLoaded", function() {
        const memberId = localStorage.getItem('MemberId');
        const role = localStorage.getItem('role');
        const loginLink = document.getElementById('login-link');
        const registerLink = document.getElementById('register-link');
        const mypageLink = document.getElementById('mypage-link');
        const logoutLink = document.getElementById('logout-link');
        const bar = document.getElementById('bar');
        const chat = document.getElementById('chat');
        if (memberId) {
            loginLink.style.display = 'none';
            registerLink.style.display = 'none';
            logoutLink.style.display = '';
            mypageLink.style.display = '';
            //bar.style.display = 'none';
            chat.style.display = '';
        } else {
            loginLink.style.display = '';
            registerLink.style.display = '';
            logoutLink.style.display = 'none';
            mypageLink.style.display = 'none';
            bar.style.display = '';
            chat.style.display = 'none';
        }
        
        if (role === null) {
            document.querySelector("a[href='/user/reserv_list']").addEventListener("click", function(event) {
                event.preventDefault();
                alert("ë¡œê·¸ì¸ í›„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            });

            document.querySelector("a[href='/webGame/']").addEventListener("click", function(event) {
                event.preventDefault();
                alert("ë¡œê·¸ì¸ í›„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            });

            document.querySelector("a[href='/qnaForm']").addEventListener("click", function(event) {
                event.preventDefault();
                alert("ë¡œê·¸ì¸ í›„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            });
        }else if(role === "ROLE_HOSPITAL"){
        	document.querySelector("a[href='/user/reserv_list']").addEventListener("click", function(event) {
                event.preventDefault();
                alert("ì¼ë°˜ íšŒì›ë§Œ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            });

            document.querySelector("a[href='/webGame/']").addEventListener("click", function(event) {
                event.preventDefault();
                alert("ì¼ë°˜ íšŒì›ë§Œ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            });

           // document.querySelector("a[href='/qnaForm']").addEventListener("click", function(event) {
           //     event.preventDefault();
           //     alert("ì¼ë°˜ íšŒì›ë§Œ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
           //});
        }

     // í˜„ì¬ URL ê°€ì ¸ì˜¤ê¸°
	    const currentPath = window.location.pathname;
		console.log(currentPath);	
	    // ëª¨ë“  nav-link ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
	    const navLinks = document.querySelectorAll('.nav-link');

	    // ê° nav-link ìš”ì†Œì— ëŒ€í•´ í˜„ì¬ URLê³¼ ë¹„êµí•˜ì—¬ active í´ë˜ìŠ¤ ì¶”ê°€
	    navLinks.forEach(function (link) {
	        if (link.getAttribute('href') === currentPath) {
	            link.classList.add('active-pet');
	        }
	    });

	    // ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ë‚´ë¶€ì˜ ë§í¬ì— ëŒ€í•´ì„œë„ ê°™ì€ ì‘ì—… ìˆ˜í–‰
	    const dropdownItems = document.querySelectorAll('.dropdown-item');
	    dropdownItems.forEach(function (item) {
	        if (item.getAttribute('href') === currentPath) {
	            item.classList.add('active-pet');
	            // ë¶€ëª¨ ë“œë¡­ë‹¤ìš´ ë§í¬ì—ë„ active í´ë˜ìŠ¤ ì¶”ê°€
	            item.closest('.dropdown').querySelector('.dropdown-toggle').classList.add('active-pet');
	        }
	    });
	    
	    // ë§Œì•½ í˜„ì¬ í˜ì´ì§€ê°€ ìƒì„¸ë³´ê¸° í˜ì´ì§€ì¸ ê²½ìš°, ë¶€ëª¨ ë©”ë‰´ì˜ active ìƒíƒœë„ ì„¤ì •
    	//if (currentPath.includes('/manager/userDetail')) {
	        // ë¶€ëª¨ ë©”ë‰´ í•­ëª©ì— active í´ë˜ìŠ¤ ì¶”ê°€
	       // const parentMenuLink = document.querySelector('a[href="/manager/userList"]');
	       // if (parentMenuLink) {
	       //     parentMenuLink.classList.add('active-pet');
	        //}
	    //}
        
    });
    
    const mobileMenu = document.querySelector("#mobileMenu");
	const mobileMenuCloseBtn = document.querySelector("#mobileMenuCloseBtn");
	
	// ëª¨ë°”ì¼ ë©”ë‰´ë¥¼ ì—´ê¸° ìœ„í•œ í•¨ìˆ˜
	function openMobileMenu() {
		mobileMenu.classList.add("open"); // open í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ì—¬ ë©”ë‰´ê°€ ë‚˜íƒ€ë‚˜ë„ë¡ í•¨
	}

	// ëª¨ë°”ì¼ ë©”ë‰´ë¥¼ ë‹«ê¸° ìœ„í•œ í•¨ìˆ˜
	function closeMobileMenu() {
		mobileMenu.classList.remove("open"); // open í´ë˜ìŠ¤ë¥¼ ì œê±°í•˜ì—¬ ë©”ë‰´ê°€ ì‚¬ë¼ì§€ë„ë¡ í•¨
	}

	// ëª¨ë°”ì¼ ë©”ë‰´ ë‹«ê¸° ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
	mobileMenuCloseBtn.addEventListener("click", function() {
	    closeMobileMenu(); // í´ë¦­ ì‹œ ëª¨ë°”ì¼ ë©”ë‰´ ë‹«ê¸°
	});
	
	
	function tokenExpired(response){
		 const msg =response.getResponseHeader("msg");
		 if(msg && msg=="tokenExpired"){
				alert("ë¡œê·¸ì¸ ì‹œê°„ ë§Œë£Œ");
				 localStorage.clear();
				 window.location.href="/login_form";
			}
	}
</script>
</div>

