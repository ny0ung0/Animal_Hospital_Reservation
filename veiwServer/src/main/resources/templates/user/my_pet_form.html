<!DOCTYPE html>
<html class="h-100" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
<title>ê²¬ê°•í• ê³ ì–‘</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<link href="/css/style.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Jua&display=swap" rel="stylesheet">
</head>
<style>
	#previewImage{
		max-width : 250px;
	}

	.container-xl{
		width : 1000px;
	}
	input[type=text],input[type=date] {
		width: 800px;
		height: 40px;
	}
	.btn-container {
        display: flex;
        justify-content: center; /* ë²„íŠ¼ì„ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì •ë ¬ */
        margin: 30px;
        
    }
    
    #regBtn {
    background-color: #4C5CB3;
    border: none;
    border-radius: 5px;
    padding: 10px 20px;
    font-size: 1rem;
    color: #ffffff;
    font-weight: bold;
    transition: background-color 0.3s, transform 0.3s, box-shadow 0.3s;
	}

	#regBtn:hover {
    background-color: #F3E2A9;
    color: black;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
	}
	
	.petInfo{
	display: flex;
    flex-direction: column;
    align-items: center; /* ê°€ë¡œ ë°©í–¥ ê°€ìš´ë° ì •ë ¬ */
    justify-content: center; /* ì„¸ë¡œ ë°©í–¥ ê°€ìš´ë° ì •ë ¬ */
    width: 100%; /* ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
    margin: 0 auto;
	}
	
	.form-select {
        width: 300px; /* ë¶€ëª¨ ìš”ì†Œì˜ í­ì„ ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
        
    }
    .col-md-6, .col-lg-3 {
        width: 300px; /* ë¶€ëª¨ ìš”ì†Œì˜ ë„ˆë¹„ë¥¼ ì „ì²´ë¡œ ì„¤ì • */
        margin-right : 20px;
    }
      h2, h3, p, label, select, input {
        font-weight: bold; /* ì§€ì •í•œ ìš”ì†Œì˜ í…ìŠ¤íŠ¸ë¥¼ êµµê²Œ ì„¤ì • */
    }
</style>
<body class="d-flex flex-column h-100">
<div th:replace="~{user/header :: header}"></div>
<div class="container-xl">


<h1 class="mt-3 mt-md-5 mb-3 mb-md-3">ğŸ¾ë‚´ ë°˜ë ¤ë™ë¬¼ ë“±ë¡</h1>
<hr>



 <div class="container-sm text-center profileImg_box position-relative">
	<p>ë°˜ë ¤ë™ë¬¼ì˜ ì‚¬ì§„ì„ ë“±ë¡í•´ì£¼ì„¸ìš”!</p>
    <img id="previewImage" src="/images/no_image2.jpg" alt="ì‚¬ì§„" class="img-fluid" ><br><br>
    <input type="file" id="fileInput" name="photo" onchange="previewFile()">
 </div>

	<div class="petInfo">
		<div class="mb-3">
		    <label for="petname" class="form-label">ë°˜ë ¤ë™ë¬¼ ì´ë¦„</label>
		    <input type="text" name="name" class="form-control" id="petname"  placeholder="ex)ì‹ë¹µì´">
		</div>
		
		<div class="row">
		    <div class="col-md-6 col-lg-3 mb-3">
		        <label for="petBigType" class="form-label">ë°˜ë ¤ë™ë¬¼ ì¢…ë¥˜</label>
		        <select id="petBigType" class="form-select" name="bigtype">
		            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
		            <option value="ê°•ì•„ì§€">ê°•ì•„ì§€</option>
		            <option value="ê³ ì–‘ì´">ê³ ì–‘ì´</option>
		            <option value="ê¸°íƒ€">ê¸°íƒ€</option>
		        </select>
		    </div>
		    <div class="col-md-6 col-lg-3 mb-3">
		        <label for="petType" class="form-label">ë°˜ë ¤ë™ë¬¼ í’ˆì¢…</label>
		        <select id="petType" class="form-select" name="type">
		            <option value="">ë°˜ë ¤ë™ë¬¼ ì¢…ë¥˜ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>
		        </select>
		    </div>
		</div>
		
		        
		<div class="mb-3">
		    <label for="birth" class="form-label">ìƒë…„ì›”ì¼</label>
		    <input type="date" name="birthdate" class="form-control" id="birth">
		</div>
		<div class="mb-3">
		    <label for="weight" class="form-label">ì²´ì¤‘ (ìˆ«ìë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”)</label>
		    <input type="text" name="weight" class="form-control" id="weight" placeholder="ex)5">
		</div>
		<div class="mb-3">
		    <label for="health" class="form-label">ê±±ì •ë˜ëŠ” ì§ˆë³‘ì´ ë¬´ì—‡ì¸ê°€ìš”?</label>
		    <input type="text" name="healthIssues" class="form-control" id="health" placeholder="ex)ë¹„ë§Œ">
		</div>
		
		<div class="mb-3">
		    <label class="form-label">ì„±ë³„</label><br>
		    <input type="radio" class="form-check-input" id="genderMale" name="gender" value="male" checked>
		    <label class="form-check-label" for="genderMale">ë‚¨ì</label><br>
		    <input type="radio" class="form-check-input" id="genderFemale" name="gender" value="female">
		    <label class="form-check-label" for="genderFemale">ì—¬ì</label>
		</div>
		
		<div class="mb-3">
		    <label class="form-label">ì¤‘ì„±í™”ì—¬ë¶€</label><br>
		    <input type="radio" class="form-check-input" id="neutered" name="isNeutered" value="true" checked>
		    <label class="form-check-label" for="neutered">ì™„ë£Œ</label><br>
		    <input type="radio" class="form-check-input" id="no_neutered" name="isNeutered" value="false">
		    <label class="form-check-label" for="no_neutered">ë¯¸ì™„ë£Œ</label>
		</div>
	
	</div>
	
<div class="btn-container">
<button type="submit" id="regBtn">ë°˜ë ¤ë™ë¬¼ ë“±ë¡í•˜ê¸°ğŸ¦´</button>
</div>


</div>
<div th:replace="~{user/footer :: footer}"></div>
<script>
const token = localStorage.getItem("token");
const MemberId = localStorage.getItem("MemberId");


document.getElementById('petBigType').addEventListener('change', function() {
    const petType = document.getElementById('petType');
    petType.innerHTML = ''; // ë‘ ë²ˆì§¸ ì…€ë ‰íŠ¸ ë°•ìŠ¤ë¥¼ ì´ˆê¸°í™”

    const petBigType = this.value;
    let options = '';

    if (petBigType === 'ê°•ì•„ì§€') {
        options = `
        	<option value="ë¯¹ìŠ¤ê²¬">ë¯¹ìŠ¤ê²¬</option>
            <option value="ì‹œë°”ê²¬">ì‹œë°”ê²¬</option>
            <option value="ë§í‹°ì¦ˆ">ë§í‹°ì¦ˆ</option>
            <option value="í¬ë©”ë¼ë‹ˆì•ˆ">í¬ë©”ë¼ë‹ˆì•ˆ</option>
            <option value="ì¹˜ì™€ì™€">ì¹˜ì™€ì™€</option>
            <option value="ì‹œì¸„">ì‹œì¸„</option>
            <option value="í‘¸ë“¤">í‘¸ë“¤</option>
            <option value="ë¶ˆë…">ë¶ˆë…</option>
            <option value="ë¹„ìˆ‘">ë¹„ìˆ‘</option>
            <option value="ë¹„ê¸€">ë¹„ê¸€</option>
            <option value="ë¸Œë¡œì½œë¦¬">ë¸Œë¡œì½œë¦¬</option>
            <option value="í•˜ìš´ë“œ">í•˜ìš´ë“œ</option>
            <option value="ì½”ì¹´ìŠ¤íŒŒë‹ˆì—˜">ì½”ì¹´ìŠ¤íŒŒë‹ˆì—˜</option>
        `;
    } else if (petBigType === 'ê³ ì–‘ì´') {
        options = `
        	<option value="ë¯¹ìŠ¤ë¬˜">ë¯¹ìŠ¤ë¬˜</option>
            <option value="í˜ë¥´ì‹œì•ˆ">í˜ë¥´ì‹œì•ˆ</option>
            <option value="ìƒ´">ìƒ´</option>
            <option value="ë©”ì¸ì¿¤">ë©”ì¸ì¿¤</option>
            <option value="ë™ëŒ">ë™ëŒ</option>
            <option value="ìŠ¤í•‘í¬ìŠ¤">ìŠ¤í•‘í¬ìŠ¤</option>
            <option value="ì•„ë©”ë¦¬ì¹¸ìˆí—¤ì–´">ì•„ë©”ë¦¬ì¹¸ìˆí—¤ì–´</option>
            <option value="í„°í‚¤ì‹œì•™ê³ ë¼">í„°í‚¤ì‹œì•™ê³ ë¼</option>
            <option value="ë…¸ë¥´ì›¨ì´ìˆ²">ë…¸ë¥´ì›¨ì´ìˆ²</option>
            <option value="ëŸ¬ì‹œì•ˆë¸”ë£¨">ëŸ¬ì‹œì•ˆë¸”ë£¨</option>
            <option value="ì¹œì¹ ë¼">ì¹œì¹ ë¼</option>
        `;
    } else if (petBigType === 'ê¸°íƒ€') {
        options = `
            <option value="í† ë¼">í† ë¼</option>
            <option value="í–„ìŠ¤í„°">í–„ìŠ¤í„°</option>
            <option value="ìƒˆ">ìƒˆ</option>
            <option value="ë¬¼ê³ ê¸°">ë¬¼ê³ ê¸°</option>
            <option value="ë„ë§ˆë±€">ë„ë§ˆë±€</option>
            <option value="ë±€">ë±€</option>
            <option value="ê±°ë¶ì´">ê±°ë¶ì´</option>
            <option value="ê¸°íƒ€">ê¸°íƒ€</option>
        `;
    }

    petType.innerHTML = options;
});


function previewFile() {
    const fileInput = document.getElementById('fileInput');
    const previewImage = document.getElementById('previewImage');

    const file = fileInput.files[0];
    const reader = new FileReader();

    reader.onloadend = function () {
        previewImage.src = reader.result;
    };

    if (file) {
        reader.readAsDataURL(file);
    }
}

document.getElementById('regBtn').addEventListener('click', function() {
    const formData = new FormData();
    const fileInput = document.querySelector('input[name="photo"]');
    const file = fileInput.files[0];

    if (file) {
        formData.append('photo', file);
    }

    formData.append('name', document.querySelector('input[name="name"]').value);
    formData.append('bigtype', document.querySelector('select[name="bigtype"]').value);
    formData.append('type', document.querySelector('select[name="type"]').value);
    formData.append('birthdate', document.querySelector('input[name="birthdate"]').value);
    formData.append('weight', document.querySelector('input[name="weight"]').value);
    formData.append('healthIssues', document.querySelector('input[name="healthIssues"]').value);
    formData.append('gender', document.querySelector('input[name="gender"]:checked').value);
    formData.append('isNeutered', document.querySelector('input[name="isNeutered"]:checked').value);

    $.ajax({
        url: "http://localhost:9001/user/mypage/myPet",
        type: "POST",
        data: formData,
        headers: {
            'Authorization': token,
            'MemberId': MemberId
        },
        processData: false,
        contentType: false,
        success: function(response) {
            console.log("ë°˜ë ¤ë™ë¬¼ ë“±ë¡ ì„±ê³µ!");
            alert("ë‚˜ì˜ ë°˜ë ¤ë™ë¬¼ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
            window.location.href = "/user/myPetList";
        },
        error: function(xhr, status, error) {
            console.error("ë°˜ë ¤ë™ë¬¼ ë“±ë¡ ì‹¤íŒ¨");
            alert("ë°˜ë ¤ë™ë¬¼ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        },
        complete: function(jqXHR, textStatus) {
            responseCheck(jqXHR);
        } 
    });
});
</script>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>